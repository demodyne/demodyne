$.widget("custom.TFOiconSelectImg",$.ui.selectmenu,{_renderItem:function(c,d){var b=$("<li>",{html:d.element.html()});var a=d.element.attr("data-style");if(typeof a!==typeof undefined&&a!==false){$("<span>",{style:d.element.attr("data-style"),"class":"ui-icon TFOOptlstFiltreImg"}).appendTo(b)}return b.appendTo(c)}});$.fn.hasExtension=function(a){return(new RegExp("("+a.join("|").replace(/\./g,"\\.")+")$","i")).test($(this).val())};function replaceDivWithUrl(c,a,b){$.get(a,function(d){$(c).replaceWith(d);if(typeof(b)=="function"){b()}}).fail(function(){})}var lastCitySearch="";var lastCountryCode=0;function setLastCitySearch(a){lastCitySearch=a}function getCities(a,f,c,g,h){console.log("GetCities");f=typeof f!=="undefined"?f:"#usrPostalcode";c=typeof c!=="undefined"?c:"#city";g=typeof g!=="undefined"?g:"#country";var i=a.data("getcities");var e=a.data("write-postal-code");var j=a.data("no-cities");var b=$(f).val();var d=$(g).is("input")?$(g).val():$(g).find(":selected").val();if(b.length<3){$(c).empty().append($("<option value>"+e+"</option>"))}else{if(lastCitySearch!=b||lastCountryCode!=d){if(typeof h!=="undefined"){$(h).show()}$.post(i,{country:d,postalcode:b},function(l){$(c).empty();if(!jQuery.isEmptyObject(l)){$.each(l,function(m){var n=$("<option></option>");n.val($(this)[0].id);n.text($(this)[0].name);$(c).append(n)})}else{var k=$("<option value>"+j+"</option>");$(c).append(k)}$(c).val($(c).children("option:first").val());if(typeof h!=="undefined"){$(h).hide()}},"json");lastCitySearch=b;lastCountryCode=d}}}var fixHelperModified=function(c,a){var b=a.children();var d=a.clone();d.children().each(function(e){$(this).width(b.eq(e).width())});return d};function renumber_table(a){$(a+" tr").each(function(){var b=$(this).parent().children().index($(this))+1;$(this).find(".priority").html(b)})}function getRegions(b){var a=$("#country").find(":selected").val();$.post(b,{country:a},function(c){$("#adminRegion").empty();if(!jQuery.isEmptyObject(c)){$.each(c,function(d){var e=$("<option></option>");e.val($(this)[0].id);e.text($(this)[0].name);$("#adminRegion").append(e)})}else{$("#adminRegion").append($("<option value>No regions for this country!</option>"))}$("#adminRegion").val($("#adminRegion option:first").val())},"json")}function checkURLInput(b){var a=b.value;if(!(/^https?:\/\//.test(a))){a="http://"+a}b.value=a}function imageUploadPreview(d,b){var c=!!d.files?d.files:[];if(!c.length||!window.FileReader){return}if(/^image/.test(c[0].type)){var a=new FileReader();a.readAsDataURL(c[0]);a.onloadend=function(){b.attr("src",this.result)}}}function modalDialog(b,e,a,g,h,d){$(".modal").remove();$(".modal-backdrop").remove();var i=typeof g!=="undefined"?(g==true?"modal-lg":g):"modal-lg";var c=typeof h!=="undefined"?h:true;var f=$('<div class="modal fade" id="'+b+'" role="dialog">').html('<div class="modal-dialog '+i+'"><div class="modal-content"><div class="modal-header round5top">'+(c?'<button type="button" class="close" data-dismiss="modal"><span style="color:#000"><i class="fa fa-times-circle"></i></span></button>':"")+'<span class="big"><img src="/img/d30.png" style="vertical-align:middle" />&nbsp;&nbsp;<strong id="modal-dialog-title">'+e+'</strong></span></div><div class="modal-body">Loading. Please wait... <i class="fa fa-spinner fa-pulse "></i> </div></div></div><script type="text/javascript">$(function () {$("#'+b+'").on("hidden.bs.modal",function(e){$(this).remove();});});	<\/script>').appendTo("body");if(a!==undefined){$(".modal-body").load(a,function(){if(typeof d==="function"){d()}})}f.modal({backdrop:"static",keyboard:false,show:true});f.on("hidden.bs.modal",function(){$(this).data("bs.modal",null)});$(".modal-dialog").draggable({handle:".modal-header"})}function newsletterAddNewsletterUpdateSendTo(){var d=$("#newsletter-add-newsletter-contacts").prop("checked")?1:0;var c=$("#newsletter-add-newsletter-citizens").prop("checked")?1:0;var a=$("#newsletter-add-newsletter-champions").prop("checked")?1:0;var b=$("#newsletter-add-newsletter-partners").prop("checked")?1:0;$("#nlSendTo").attr("value",d<<3|c<<2|a<<1|b)}function nl2br(c,b){var a=(b||typeof b==="undefined")?"<br />":"<br>";return(c+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+a+"$2")}function profileDetailsInPopup(b,a){if(!$('div#mini-profile[data-id="'+a+'"]').length){$('<div id="mini-profile" data-id="'+a+'" style="display:none">').html("Loading...").appendTo("#pageContent");$.ajax({url:b.attr("href"),success:function(c){$('div#mini-profile[data-id="'+a+'"]').html(c);b.popover("show")}})}return $('div#mini-profile[data-id="'+a+'"]').html()}function updateInboxLists(a){if(a=="received"||a=="all"){if(typeof $("#inbox-list-received").data("url")!=="undefined"){$.get($("#inbox-list-received").data("url"),function(b){var c=$("#inbox-list-received").css("display");$("#inbox-list-received").replaceWith(b);$("#inbox-list-received").css("display",c)})}}if(a=="sent"||a=="all"){if(typeof $("#inbox-list-sent").data("url")!=="undefined"){$.get($("#inbox-list-sent").data("url"),function(b){var c=$("#inbox-list-sent").css("display");$("#inbox-list-sent").replaceWith(b);$("#inbox-list-sent").css("display",c)})}}if(a=="trash"||a=="all"){if(typeof $("#inbox-list-trash").data("url")!=="undefined"){$.get($("#inbox-list-trash").data("url"),function(b){var c=$("#inbox-list-trash").css("display");$("#inbox-list-trash").replaceWith(b);$("#inbox-list-trash").css("display",c)})}}}function updatePages(a){a.forEach(function(c,b){if($(c).length){if(typeof $(c).data("url")!=="undefined"){$(c).parent().load($(c).data("url"))}}})}function userMiniProfilePopover(a){a.popover({trigger:"manual",html:true,placement:"auto",container:"body",animation:false,content:function(){return profileDetailsInPopup($(this),$(this).data("id"))}}).on("click",function(){var b=this;$(".popover").popover("hide");$(this).popover("show");return false})}function moveSelect2Select(b,a){if(b==="undefined"){return}b.each(function(){var c=$(this).parent();var d=c.attr("label");if(a.children('optgroup[label="'+d+'"]').html()==null){a.append('<optgroup label="'+d+'"  style="padding: 5px 0 10px 0;border-top: #dedede 1px solid;" ></optgroup>');a.children('optgroup[label="'+d+'"]').append($(this))}else{a.children('optgroup[label="'+d+'"]').append($(this))}if(c.children().length==0){c.remove()}})}function removeEmptyGroups(){$("select").each(function(){$;$(this).find("optgroup").each(function(){if($(this).children().length==0){$(this).remove()}})})}function orderOptgroups(){$("select").each(function(){var b=$(this);var a=b.find("optgroup");a.remove();a=a.sort(function(d,c){return d.label.localeCompare(c.label)});b.append(a);a.each(function(){var d=$(this);var c=d.find("option");c.remove();c=c.sort(function(f,e){return f.innerHTML.localeCompare(e.innerHTML)});d.append(c)})})}function sortSelect(){$("select").each(function(){var a=$(this),b=a.children().toArray().sort(function(d,c){return $(d).text()<$(c).text()?1:-1});$.each(b,function(d,c){a.prepend(c)})})}function updateSubCategories(b,a){$("#add-proposal-category-image").html('<i class="fa fa-spinner fa-pulse fa-2x"></i>');$.post(a,{main_category:b},function(e){$("#sub_category option").remove();if(typeof e.name!="undefined"){for(var c=0;c<e.name.length;c++){$("#sub_category").append('<option value="'+e.id[c]+'">'+e.name[c]+"</option>")}}var d=$("#main_category").find("option:selected").css("background-image");d=d.substring(4,d.length-1);$("#add-proposal-category-image").html('<img width="32px" height="32px" src='+d+">")},"json");return false};