<?php /** * @link      https://github.com/demodyne/demodyne * @copyright Copyright (c) 2015-2016 Demodyne (https://www.demodyne.org) * @license   http://www.gnu.org/licenses/agpl.html GNU Affero General Public License */namespace DGIModule\Form;use Zend\Form\Form;use Zend\InputFilter\InputFilterProviderInterface;use Zend\Stdlib\Hydrator\ClassMethods;use DGIModule\Entity\Bug;class AddEditBugForm extends Form implements InputFilterProviderInterface {     public function __construct()     {         parent::__construct('bug-form');         $this             ->setObject(new Bug())             ->setAttribute('name', 'bug')         ;             $this->setAttribute('enctype', 'multipart/form-data');             $this->setAttribute('method', 'post');             $this->setHydrator(new ClassMethods());             $this->add(array(                 'name' => 'bugTitle',                 'attributes' => array(                     'type'  => 'text',                     'class'=>'form-control text-change',                     'id' => 'bugTitle',                     'maxlength' => 100,                 ),             ));                          $this->add([                 'type' => 'Zend\Form\Element\Textarea',                 'name' => 'bugDescription',                 'attributes' => array(                     'rows' => 5,                     'class'=>'form-control text-change',                     'id' => 'bugDescription',                     'maxlength' => 5000,                 ),             ]);             $this->add([                 'type' => 'Zend\Form\Element\File',                 'name' => 'bugImage',                 'attributes' => array(                     'type' => 'file',                     'accept' => 'image/*',                     'id' => 'bugImage'                 ),             ]);     }     /**      * @return array      */     public function getInputFilterSpecification()     {         return array(             'bugTitle' => array(                 'required' => true,                 'filters'  => array(                     array('name' => 'StripTags'),                     array('name' => 'StringTrim'),                 ),                 'validators' => array(                     array(                         'name'    => 'NotEmpty',                         'options' => array(                            'messages' => array(\Zend\Validator\NotEmpty::IS_EMPTY  => _("You must provide a bug subject."))                         ),                     ),                     array(                         'name'    => 'StringLength',                         'options' => array(                             'encoding' => 'UTF-8',                             'max'      => 100,                             'messages' => array(\Zend\Validator\StringLength::TOO_LONG  => _("The bug subject is more than %max% characters long"))                         ),                     ),                 ),             ),             'bugDescription' => array(                 'required' => true,                 'filters' => array(                     array('name' => 'StripTags'),                     array('name' => 'StringTrim'),                 ),                 'validators' => array(                     array(                         'name' => 'StringLength',                         'options' => array(                             'encoding' => 'UTF-8',                             'max' => 5000                         ),                     ),                     array(                         'name'    => 'NotEmpty',                         'options' => array(                             'messages' => array(\Zend\Validator\NotEmpty::IS_EMPTY  => _("You must provide a bug description."))                         ),                     ),                 ),             ),                          'bugImage' => array(                 'required' => false,                 'validators' => array(                     array(                         'name'    => 'NotEmpty',                         'options' => array(                             'messages' => array(\Zend\Validator\NotEmpty::IS_EMPTY  => _("You must provide an image file."))                         ),                     ),                     array(                         'name'    => 'Zend\Validator\File\UploadFile',                         'options' => array(                             'messages' => array(                                 \Zend\Validator\File\UploadFile::NO_FILE  => _("The bug image was not uploaded"),                             )                         ),                     ),                     array(                         'name'    => 'Zend\Validator\File\Size',                         'options' => array(                             'max'      => 1048576, // 1MB                             'messages' => array(                                 \Zend\Validator\File\Size::TOO_BIG  => _("Maximum allowed size for file is '%max%' but '%size%' detected"),                                 \Zend\Validator\File\Size::NOT_FOUND  => _("File is not readable or does not exist"),                             )                         ),                     ),                                      ),             )         );     } } 